Udon Video Decoder
==================

Udon Video Decoder is a library for loading videos generated by [Pixel Proxy](https://gitlab.com/anfaux/pixel-proxy), allowing you to load arbitrary API calls into VRChat.

See [VideoDecodeExample.cs](./VideoDecodeExample.cs) for a complete usage example.

Some demos are available in the [Udon Video Decode Demo](https://vrchat.com/home/world/wrld_7508e408-ba6a-4478-b772-6af430c89286) VRChat world.

Dependencies
------------

* VRCSDK3
* [UdonSharp](https://github.com/MerlinVR/UdonSharp)
* Optionally [UdonDecodeLib](https://github.com/Roliga/UdonDecodeLib) and [UdonXML](https://github.com/Foorack/UdonXML) for decoding the received data.

Scene Setup
-----------

1. Create an empty GameObject in your scene and attach the `VideoDecoder.cs` script to it.
2. Pick a Render Texture and Blank Texture in the Video Decoder settings. Some preset ones are provided with this package. If you make your own, make sure that:
  - These textures match in size.
  - The blank texture has Read/write enable.
  - The Blank Texture has Compression disabled.
3. In your own program, define a variable like `public VideoDecoder videoDecoder`.
4. Assign the Video Decoder GameObject to this variable.
5. You can now call `videoDecoder.LoadURL` to load your data.

API
---

**LoadURL**

`LoadURL(VRCUrl url, UdonSharpBehaviour callbackBehaviour, string callbackField, string callbackMethod, string callbackErrorField, string callbackErrorMethod)`

Loads the specified URL asynchronously.

* `callbackBehaviour`: The UdonSharpBehaviour that the following callbacks reside in.
* `callbackField`: Name of field to put the returned data on. Type of this field should be `byte[]`.
* `callbackMethod`: Name of method to call on success.
* `callbackErrorField` Name of field to put load error code in. Type of this field should be `VRC.SDK3.Components.Video.VideoError`.
* `callbackErrorMethod`: Method to call on failure.

Any of the `callback*` parameters can be set to `null` if you don't need them.

**CancelLoad**

`CancelLoad()`

Stops the internal video player, cancelling any currently loading data.
